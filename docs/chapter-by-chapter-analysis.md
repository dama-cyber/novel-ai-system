# 强制逐章累积分析器（拆书模块）使用指南

## 简介

强制逐章累积分析器基于"强制逐章累积分析师"的概念模型，通过AI驱动逐章分析并累积形成完整的小说分析报告。该系统实现了：

1. 逐章深度分析
2. 数据累积合并
3. 智能报告生成
4. 质量控制与一致性保持

## 功能说明

### 1. 初始化累积分析 (init)
```
na a-init <项目路径> <小说名>
```

创建新的累积分析项目，生成初始报告框架。

### 2. 逐章分析并累积 (analyze)
```
na a-analyze <项目路径> <章节号> <章节内容文件路径>
```

对指定章节进行深度分析，并将结果累积到现有报告中。

### 3. 查看累积报告 (view)
```
na a-view <项目路径>
```

查看当前累积分析报告的完整内容。

### 4. 导出完整报告 (export)
```
na a-export <项目路径> <输出路径>
```

导出完整的累积分析报告到指定路径。

## 分析维度

系统基于"强制逐章累积分析师"的标准，对每一章进行六个维度的分析：

### 1. 文风指纹 (Stylometric Fingerprint)
- 口头禅与常用表达
- 固定句式与节奏偏好
- 词汇选择偏好
- 句子构造习惯
- 生活经历线索
- 行业/地域词汇
- 自然化缺陷
- 写作忌口与避讳
- 比喻口味与意象库
- 思维模式与表达逻辑
- 常见场景说话方式
- 个人价值取向与反复母题

### 2. 剧情与结构分析 (Plot & Structural Analysis)
- 主线剧情分析
- 支线剧情分析
- 细纲
- 场景纲
- 爽点
- 节奏

### 3. 角色分析 (Character Analysis)
- 主角成长弧光
- 配角功能分析
- 人物关系网络

### 4. 主题与情感 (Theme & Emotion)
- 核心主题识别
- 情感纽带分析
- 情感表达方式

### 5. 风格与技巧 (Style & Technique)
- 叙事风格
- 叙事技巧
- 人物刻画手法
- 情节构建手法

### 6. 感悟与评价 (Reflection & Critique)
- 个人感悟
- 优点总结
- 不足分析

## 使用工作流

### 1. 完整分析流程示例
```bash
# 初始化分析项目
na a-init "./projects/我的玄幻小说" "星辰变"

# 逐章分析（按顺序进行）
na a-analyze "./projects/我的玄幻小说" 1 "./chapters/chapter_001_content.txt"
na a-analyze "./projects/我的玄幻小说" 2 "./chapters/chapter_002_content.txt"
na a-analyze "./projects/我的玄幻小说" 3 "./chapters/chapter_003_content.txt"
# ... 继续直到完成

# 查看累积报告
na a-view "./projects/我的玄幻小说"

# 导出最终报告
na a-export "./projects/我的玄幻小说" "./exports/final-analysis.md"
```

### 2. 与其他模块集成
```bash
# 在沙盒创作后进行分析
na x-sbox "./projects/我的小说"
na a-analyze "./projects/我的小说" 1 "./chapters/chapter_001_content.txt"
na a-analyze "./projects/我的小说" 2 "./chapters/chapter_002_content.txt"

# 分析后进行质量改进
na a-view "./projects/我的小说"  # 查看分析结果
# 根据分析结果人工或自动调整后续创作
```

## 累积逻辑

系统遵循严格的累积合并规则：
- 列表型数据（如口头禅、爽点等）会被添加到现有列表中，重复项会被合并
- 描述型数据（如思维模式、主线剧情等）会被更新以反映新章节的内容
- 每次分析都会完整保留之前的分析内容，仅添加新章节的分析结果
- 报告标题会更新以反映当前累积章节数

## 优势

1. **逐章精度**: 提供更细致的章节级分析
2. **累积智能**: 保持跨章节的一致性分析
3. **AI赋能**: 利用Qwen的分析能力
4. **完整性**: 保持所有分析内容的完整性
5. **可追溯**: 每章分析都有清晰的时间节点

## 注意事项

1. 章节分析必须按顺序进行，确保累积的连续性
2. 使用相对较大的上下文窗口以充分分析内容
3. 定期备份累积报告以防数据丢失
4. 可结合其他模块（如修订、质量检查）使用